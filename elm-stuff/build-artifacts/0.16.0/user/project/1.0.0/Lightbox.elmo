Elm.Lightbox = Elm.Lightbox || {};
Elm.Lightbox.make = function (_elm) {
   "use strict";
   _elm.Lightbox = _elm.Lightbox || {};
   if (_elm.Lightbox.values) return _elm.Lightbox.values;
   var _U = Elm.Native.Utils.make(_elm),
   $Basics = Elm.Basics.make(_elm),
   $Date = Elm.Date.make(_elm),
   $Debug = Elm.Debug.make(_elm),
   $Html = Elm.Html.make(_elm),
   $Html$Attributes = Elm.Html.Attributes.make(_elm),
   $Html$Events = Elm.Html.Events.make(_elm),
   $Json$Decode = Elm.Json.Decode.make(_elm),
   $List = Elm.List.make(_elm),
   $Maybe = Elm.Maybe.make(_elm),
   $Result = Elm.Result.make(_elm),
   $Signal = Elm.Signal.make(_elm),
   $Streams = Elm.Streams.make(_elm);
   var _op = {};
   var messageOn = F3(function (name,addr,msg) {
      return A3($Html$Events.on,name,$Json$Decode.value,function (_p0) {    return A2($Signal.message,addr,msg);});
   });
   var targetSrc = A2($Json$Decode.at,_U.list(["target","src"]),$Json$Decode.string);
   var onLoad = messageOn("load");
   var myStyle = $Html$Attributes.style(_U.list([{ctor: "_Tuple2",_0: "animation",_1: "fadein 2s"}]));
   var update = F2(function (action,model) {
      var _p1 = action;
      switch (_p1.ctor)
      {case "NoOp": return model;
         case "Left": return _U.update(model,{pictures: $Streams.left(function (_) {    return _.pictures;}(model)),loading: true});
         case "Right": return _U.update(model,{pictures: $Streams.right(function (_) {    return _.pictures;}(model)),loading: true});
         case "Close": return _U.update(model,{display: false,loading: false});
         case "GoTo": var _p2 = _p1._0;
           return _U.update(model,
           {pictures: A2($Streams.goTo,
           function (_) {
              return _.pictures;
           }(model),
           function (p) {
              return _U.eq(function (_) {    return _.filename;}(p),_p2);
           })
           ,display: true
           ,loading: $Basics.not(_U.eq(_p2,function (_) {    return _.filename;}($Streams.current(function (_) {    return _.pictures;}(model)))))});
         default: return _U.update(model,{loading: false});}
   });
   var Loaded = {ctor: "Loaded"};
   var GoTo = function (a) {    return {ctor: "GoTo",_0: a};};
   var thumbs = F2(function (address,model) {
      var thumb = function (n) {
         return A2($Html.a,
         _U.list([A2($Html$Events.onClick,address,GoTo(n))]),
         _U.list([A2($Html.img,
         _U.list([$Html$Attributes.src(A2($Basics._op["++"],
         "images/",
         A2($Basics._op["++"],function (_) {    return _.folder;}(model),A2($Basics._op["++"],"/thumbs/",n))))]),
         _U.list([]))]));
      };
      var nameList = function (_) {    return _.nameList;}(model);
      return A2($Html.div,_U.list([$Html$Attributes.$class("thumbs")]),A2($List.map,thumb,nameList));
   });
   var Close = {ctor: "Close"};
   var Right = {ctor: "Right"};
   var Left = {ctor: "Left"};
   var NoOp = {ctor: "NoOp"};
   var onKey = function (address) {
      var keyToAct = function (key) {    return _U.eq(key,13) || _U.eq(key,39) ? Right : _U.eq(key,37) ? Left : _U.eq(key,27) ? Close : NoOp;};
      return A2($Html$Events.onKeyDown,address,keyToAct);
   };
   var lightbox = F2(function (address,model) {
      var currentPic = $Streams.current(function (_) {    return _.pictures;}(model));
      return A2($Html.div,
      _U.list([$Html$Attributes.classList(_U.list([{ctor: "_Tuple2",_0: "lightbox",_1: true}
                                                  ,{ctor: "_Tuple2",_0: "display",_1: function (_) {    return _.display;}(model)}]))
              ,onKey(address)
              ,$Html$Attributes.tabindex(0)
              ,$Html$Attributes.autofocus(true)]),
      _U.list([A2($Html.div,
      _U.list([$Html$Attributes.$class("lightbox-content"),onKey(address),$Html$Attributes.tabindex(0),$Html$Attributes.autofocus(true)]),
      _U.list([A2($Html.div,
              _U.list([$Html$Attributes.$class("picContainer")]),
              _U.list([A2($Html.img,
                      _U.list([$Html$Attributes.src(A2($Basics._op["++"],
                              "images/",
                              A2($Basics._op["++"],
                              function (_) {
                                 return _.folder;
                              }(model),
                              A2($Basics._op["++"],"/",function (_) {    return _.filename;}(currentPic)))))
                              ,A3($Html$Events.on,
                              "load",
                              targetSrc,
                              function (_p3) {
                                 return A2($Signal.message,address,function (s) {    return Loaded;}(_p3));
                              })]),
                      _U.list([]))
                      ,A2($Html.div,
                      _U.list([$Html$Attributes.$class("halfPic"),$Html$Attributes.id("halfPicleft"),A2($Html$Events.onClick,address,Left)]),
                      _U.list([A2($Html.span,_U.list([$Html$Attributes.$class("noselect")]),_U.list([$Html.text("<<")]))]))
                      ,A2($Html.div,
                      _U.list([$Html$Attributes.$class("halfPic"),$Html$Attributes.id("halfPicright"),A2($Html$Events.onClick,address,Right)]),
                      _U.list([A2($Html.span,_U.list([$Html$Attributes.$class("noselect")]),_U.list([$Html.text(">>")]))]))]))
              ,A2($Html.div,
              _U.list([$Html$Attributes.$class("lightBoxcaption")]),
              _U.list([$Html.text(A2($Maybe.withDefault,"",function (_) {    return _.caption;}(currentPic)))
                      ,A2($Html.a,
                      _U.list([$Html$Attributes.id("closebtn"),$Html$Attributes.$class("noselect"),A2($Html$Events.onClick,address,Close)]),
                      _U.list([A2($Html.i,_U.list([$Html$Attributes.$class("fa fa-times")]),_U.list([]))]))
                      ,A2($Html.a,
                      _U.list([$Html$Attributes.classList(_U.list([{ctor: "_Tuple2",_0: "loader",_1: true}
                                                                  ,{ctor: "_Tuple2"
                                                                   ,_0: "display"
                                                                   ,_1: function (_) {
                                                                      return _.loading;
                                                                   }(model) && function (_) {
                                                                      return _.display;
                                                                   }(model)}]))]),
                      _U.list([function (_) {
                         return _.loading;
                      }(model) ? A2($Html.i,_U.list([$Html$Attributes.$class("fa fa-spinner fa-spin")]),_U.list([])) : A2($Html.i,
                      _U.list([]),
                      _U.list([]))]))]))]))]));
   });
   var view = F2(function (address,model) {    return A2($Html.div,_U.list([]),_U.list([A2(thumbs,address,model),A2(lightbox,address,model)]));});
   var picCaption = F2(function (cs,ps) {
      var addCaption = function (p) {
         var caption = function () {
            var _p6 = $List.head(A2($List.filter,function (_p4) {    var _p5 = _p4;return _U.eq(function (_) {    return _.filename;}(p),_p5._0);},cs));
            if (_p6.ctor === "Nothing") {
                  return $Maybe.Nothing;
               } else {
                  return $Maybe.Just(_p6._0._1);
               }
         }();
         return _U.update(p,{caption: caption});
      };
      return A2($List.map,addCaption,ps);
   });
   var Picture = F5(function (a,b,c,d,e) {    return {filename: a,author: b,date: c,caption: d,linkHD: e};});
   var defPic = A5(Picture,"",$Maybe.Nothing,$Maybe.Nothing,$Maybe.Just(""),false);
   var picList = function (n) {
      var go = function (m) {
         var filename = _U.cmp(n - m,10) < 0 ? A2($Basics._op["++"],"0",A2($Basics._op["++"],$Basics.toString(n - m),".jpg")) : A2($Basics._op["++"],
         $Basics.toString(n - m),
         ".jpg");
         var pic = _U.update(defPic,{filename: filename,caption: $Maybe.Just("")});
         return _U.eq(m,-1) ? _U.list([]) : A2($List._op["::"],pic,go(m - 1));
      };
      return go(n - 1);
   };
   var Model = F6(function (a,b,c,d,e,f) {    return {pictures: a,nameList: b,folder: c,display: d,diaporama: e,loading: f};});
   var init = F2(function (pics,folder) {
      var nameList = A2($List.map,function (_) {    return _.filename;},pics);
      return A6(Model,A2($Streams.biStream,pics,defPic),nameList,folder,false,false,false);
   });
   return _elm.Lightbox.values = {_op: _op
                                 ,init: init
                                 ,update: update
                                 ,view: view
                                 ,defPic: defPic
                                 ,picList: picList
                                 ,picCaption: picCaption
                                 ,Picture: Picture
                                 ,Model: Model
                                 ,NoOp: NoOp
                                 ,Left: Left
                                 ,Right: Right
                                 ,Close: Close
                                 ,GoTo: GoTo
                                 ,Loaded: Loaded};
};